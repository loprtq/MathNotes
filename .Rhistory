mM.orth1 = lmer(distance ~ age + (1 | Subject), data = OrthMale)
# Packages
library(nlme); library(lme4); library(lmerTest); library(ggplot2)
# Data set
data("Orthodont")
OrthMale = Orthodont[1:64,]
OrthFema = Orthodont[65:108,]
# Models
mA.orth1 = lmer(distance ~ age + (1 | Subject), data = Orthodont)
mA.orth2 = lmer(distance ~ age + (1 | Subject), data = Orthodont, REML = FALSE)
mA.orth1@beta; mA.orth2@beta   # Fixed effects
mA.orth1@u; mA.orth2@u         # Random Effects
mA.orth1@sigma; mA.orth2@sigma # tau
mA.orth1@theta; mA.orth2@theta # Sigma
mF.orth1 = lmer(distance ~ age + (1 | Subject), data = OrthFema)
mF.orth2 = lmer(distance ~ age + (1 | Subject), data = OrthFema, REML = FALSE)
mF.orth1@beta; mF.orth2@beta
mF.orth1@u; mF.orth2@u
mF.orth1 # REML
mF.orth2 # MLE
mM.orth1 = lmer(distance ~ age + (1 | Subject), data = OrthMale)
mM.orth2 = lmer(distance ~ age + (1 | Subject), data = OrthMale, REML = FALSE)
mM.orth1@beta;  mM.orth2@beta  # Fixed effects
mM.orth1@u;     mM.orth2@u     # Random Effects
mM.orth1@sigma; mM.orth2@sigma # Sigma
mM.orth1 # REML
mM.orth2 # MLE
# Plots
ggplot(data = OrthMale, aes(y = distance, x = age, group = Subject, color = Subject)) +
theme_minimal() +
theme(legend.position = "none") +
geom_point() +
geom_line() +
scale_fill_manual(values = rainbow(16)) +
ylab("Distance") + xlab("Age")
plot(mM.orth1)
plot(predict(mM.orth1))
plot(OrthMale$age,predict(mM.orth1))
setwd("C:/Users/jonas/OneDrive/Microsoft Visual Studio Code/MathNotes")
